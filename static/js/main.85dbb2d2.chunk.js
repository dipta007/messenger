(this.webpackJsonpclient=this.webpackJsonpclient||[]).push([[0],{135:function(e,a,t){e.exports=t(212)},140:function(e,a,t){},175:function(e,a,t){},176:function(e,a,t){},177:function(e,a,t){},178:function(e,a,t){},205:function(e,a){},209:function(e,a,t){},210:function(e,a,t){},211:function(e,a,t){},212:function(e,a,t){"use strict";t.r(a);var n=t(0),r=t.n(n),c=t(10),o=t.n(c),l=(t(140),t(25)),i=t(11),s=t(48),u=t(33),m=t(252),d=t(67),f=t(18),p=t.n(f),v=t(26),g=t(15),b=t(264),E=t(261),h=t(259),j=t(253),O=t(260),y=t(62),S=t.n(y),w=t(80),k=t(250),x=t(251),N=t(77),C=t.n(N),I=C.a.create({baseURL:"".concat("http://localhost:8080"),headers:{Authorization:localStorage.getItem("token")?"Bearer ".concat(localStorage.getItem("token")):null}});function W(){return r.a.createElement(w.a,{variant:"body2",color:"textSecondary",align:"center"},"Copyright \xa9 ",r.a.createElement(l.b,{color:"inherit",to:"https://material-ui.com/"},"dipta007")," ",(new Date).getFullYear(),".")}var q=Object(k.a)((function(e){return{paper:{marginTop:e.spacing(8),display:"flex",flexDirection:"column",alignItems:"center"},avatar:{margin:e.spacing(1),backgroundColor:e.palette.secondary.main},form:{width:"100%",marginTop:e.spacing(1)},submit:{margin:e.spacing(3,0,2)}}}));function D(){var e,a=q(),t=r.a.useState(""),n=Object(g.a)(t,2),c=n[0],o=n[1],s=r.a.useState(""),f=Object(g.a)(s,2),y=f[0],k=f[1],N=Object(u.b)().enqueueSnackbar,C=Object(i.f)(),D=function(){var e=Object(v.a)(p.a.mark((function e(a){var t;return p.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return a.preventDefault(),e.prev=1,e.next=4,I.post("/login",{username:c,password:y});case 4:t=e.sent,localStorage.setItem("token",t.data.access_token),localStorage.setItem("userId",t.data.userId),C.replace("/chat"),e.next=13;break;case 10:e.prev=10,e.t0=e.catch(1),N(e.t0.response.data.message,{variant:"error"});case 13:case"end":return e.stop()}}),e,null,[[1,10]])})));return function(a){return e.apply(this,arguments)}}();return r.a.useEffect((function(){localStorage.getItem("token")&&C.replace("/chat")}),[]),r.a.createElement(x.a,{component:"main",maxWidth:"xs"},r.a.createElement(m.a,null),r.a.createElement("div",{className:a.paper},r.a.createElement(b.a,{className:a.avatar},r.a.createElement(S.a,null)),r.a.createElement(w.a,{component:"h1",variant:"h5"},"Sign in"),r.a.createElement("form",{className:a.form,onSubmit:D},r.a.createElement(h.a,{variant:"outlined",margin:"normal",required:!0,fullWidth:!0,label:"Email Address",name:"email",autoComplete:"email",autoFocus:!0,onChange:function(e){return o(e.target.value)},value:c}),r.a.createElement(h.a,(e={variant:"outlined",margin:"normal",required:!0,fullWidth:!0,name:"password",label:"Password",type:"password",autoComplete:"current-password"},Object(d.a)(e,"type","password"),Object(d.a)(e,"onChange",(function(e){return k(e.target.value)})),Object(d.a)(e,"value",y),e)),r.a.createElement(E.a,{type:"submit",fullWidth:!0,variant:"contained",color:"primary",className:a.submit},"Sign In"),r.a.createElement(j.a,{container:!0},r.a.createElement(j.a,{item:!0},r.a.createElement(l.b,{to:"/signup",variant:"body2"},"Don't have an account? Sign Up"))))),r.a.createElement(O.a,{mt:8},r.a.createElement(W,null)))}var F=t(254);function T(){return r.a.createElement(w.a,{variant:"body2",color:"textSecondary",align:"center"},"Copyright \xa9 ",r.a.createElement(F.a,{color:"inherit",href:"/"},"dipta007")," ",(new Date).getFullYear(),".")}var M=Object(k.a)((function(e){return{paper:{marginTop:e.spacing(8),display:"flex",flexDirection:"column",alignItems:"center"},avatar:{margin:e.spacing(1),backgroundColor:e.palette.secondary.main},form:{width:"100%",marginTop:e.spacing(3)},submit:{margin:e.spacing(3,0,2)}}}));function A(){var e=M(),a=r.a.useState(""),t=Object(g.a)(a,2),n=t[0],c=t[1],o=r.a.useState(""),l=Object(g.a)(o,2),s=l[0],m=l[1],d=r.a.useState(""),f=Object(g.a)(d,2),y=f[0],k=f[1],N=Object(i.f)(),C=Object(u.b)(),W=C.enqueueSnackbar,q=(C.closeSnackbar,function(){var e=Object(v.a)(p.a.mark((function e(a){return p.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(a.preventDefault(),!(n&&s&&y)){e.next=13;break}return e.prev=2,e.next=5,I.post("/signup",{name:n,username:s,password:y});case 5:N.push("/"),e.next=11;break;case 8:e.prev=8,e.t0=e.catch(2),W(e.t0.response.data.message,{variant:"error"});case 11:e.next=14;break;case 13:W("Please provide all the fields",{variant:"warning"});case 14:case"end":return e.stop()}}),e,null,[[2,8]])})));return function(a){return e.apply(this,arguments)}}());return r.a.createElement(x.a,{component:"main",maxWidth:"xs"},r.a.createElement("div",{className:e.paper},r.a.createElement(b.a,{className:e.avatar},r.a.createElement(S.a,null)),r.a.createElement(w.a,{component:"h1",variant:"h5"},"Sign up"),r.a.createElement("form",{className:e.form,onSubmit:q},r.a.createElement(j.a,{container:!0,spacing:2},r.a.createElement(j.a,{item:!0,xs:12},r.a.createElement(h.a,{label:"Name",onChange:function(e){return c(e.target.value)},variant:"outlined",required:!0,fullWidth:!0,autoFocus:!0,value:n})),r.a.createElement(j.a,{item:!0,xs:12},r.a.createElement(h.a,{variant:"outlined",required:!0,fullWidth:!0,label:"Email Address",name:"email",autoComplete:"email",onChange:function(e){return m(e.target.value)},value:s})),r.a.createElement(j.a,{item:!0,xs:12},r.a.createElement(h.a,{variant:"outlined",required:!0,fullWidth:!0,name:"password",label:"Password",type:"password",autoComplete:"current-password",onChange:function(e){return k(e.target.value)},value:y}))),r.a.createElement(E.a,{type:"submit",fullWidth:!0,variant:"contained",color:"primary",className:e.submit},"Sign Up"),r.a.createElement(j.a,{container:!0,justify:"flex-end"},r.a.createElement(j.a,{item:!0},r.a.createElement(F.a,{href:"/",variant:"body2"},"Already have an account? Sign in"))))),r.a.createElement(O.a,{mt:5},r.a.createElement(T,null)))}var L=t(43),_=t(114),J=t(66),U=t.n(J);t(175);function B(e){var a=e.id,t=e.photo,c=e.name,o=e.text;Object(n.useEffect)((function(){Object(_.a)(".conversation-snippet",20)}));var l=Object(i.f)(),s=Object(i.g)(),u=U.a.parse(s.search).room;return r.a.createElement("div",{className:"conversation-list-item ".concat(u===a?"active":""),onClick:function(){return l.push("/chat?room=".concat(a))}},r.a.createElement("img",{className:"conversation-photo",src:t,alt:"conversation"}),r.a.createElement("div",{className:"conversation-info"},r.a.createElement("h1",{className:"conversation-title"},c),r.a.createElement("p",{className:"conversation-snippet"},o)))}t(176);function P(e){var a=e.title,t=e.leftItems,n=e.rightItems;return r.a.createElement("div",{className:"toolbar"},r.a.createElement("div",{className:"left-items"},t),r.a.createElement("h1",{className:"toolbar-title"},a),r.a.createElement("div",{className:"right-items"},n))}t(177);function R(e){var a=e.icon,t=e.onClick,n=void 0===t?function(){}:t;return r.a.createElement("i",{className:"toolbar-button ".concat(a),onClick:n})}var Y=t(263),z=t(255),G=t(256),V=t(257),$=t(258);var H=function(e){var a=e.isOpen,t=e.handleClose,n=r.a.useState(""),c=Object(g.a)(n,2),o=c[0],l=c[1],s=r.a.useState(""),m=Object(g.a)(s,2),d=m[0],f=m[1],b=Object(i.f)(),j=Object(u.b)().enqueueSnackbar,O=function(){var e=Object(v.a)(p.a.mark((function e(){var a,n;return p.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.prev=0,e.next=3,I.post("/conversations/open",{name:d,username:o});case 3:(null===(n=e.sent)||void 0===n||null===(a=n.data)||void 0===a?void 0:a._id)?(f(""),l(""),t(),b.push("/chat?room=".concat(n.data._id))):j("User Not Found",{variant:"warning"}),e.next=10;break;case 7:e.prev=7,e.t0=e.catch(0),console.log(e.t0);case 10:case"end":return e.stop()}}),e,null,[[0,7]])})));return function(){return e.apply(this,arguments)}}();return r.a.createElement(Y.a,{open:a,onClose:t},r.a.createElement(z.a,{id:"form-dialog-title"},"Find your Friend"),r.a.createElement(G.a,null,r.a.createElement(V.a,null,"Type in the conversation name and friends email address"),r.a.createElement(h.a,{autoFocus:!0,margin:"dense",label:"Conversation Name",type:"text",fullWidth:!0,value:d,onChange:function(e){return f(e.target.value)}}),r.a.createElement(h.a,{margin:"dense",label:"Email Address",type:"email",fullWidth:!0,value:o,onChange:function(e){return l(e.target.value)}})),r.a.createElement($.a,null,r.a.createElement(E.a,{onClick:t,color:"primary"},"Cancel"),r.a.createElement(E.a,{onClick:O,color:"primary"},"Create")))};t(178);function K(e){var a=e.setSelectedConversation,t=Object(n.useState)([]),c=Object(g.a)(t,2),o=c[0],l=c[1],i=Object(n.useState)(!1),s=Object(g.a)(i,2),u=s[0],m=s[1];Object(n.useEffect)((function(){d()}),[]);var d=function(){var e=Object(v.a)(p.a.mark((function e(){var a,t,n;return p.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,I.get("/conversations/list");case 2:t=e.sent,(n=null===t||void 0===t||null===(a=t.data)||void 0===a?void 0:a.map((function(e){var a;return{id:e._id,photo:(null===e||void 0===e||null===(a=e.picture)||void 0===a?void 0:a.large)||"https://pbs.twimg.com/profile_images/857490466572443648/c05JqEgo.jpg",name:"".concat(e.name),text:""}})))&&l([].concat(Object(L.a)(o),Object(L.a)(n)));case 5:case"end":return e.stop()}}),e)})));return function(){return e.apply(this,arguments)}}();return r.a.createElement("div",{className:"conversation-list"},r.a.createElement(P,{title:"Messenger",leftItems:[],rightItems:[r.a.createElement(R,{key:"add",icon:"ion-ios-add-circle-outline",onClick:function(){return m(!0)}})]}),o.map((function(e){return r.a.createElement(B,Object.assign({key:e.name},e,{setSelectedConversation:a}))})),r.a.createElement(H,{isOpen:u,handleClose:function(){return m(!1)}}))}var Q=t(115),X=t.n(Q),Z=t(36),ee=t.n(Z);t(209);function ae(e){var a=e.data,t=e.isMine,n=e.startsSequence,c=e.endsSequence,o=e.showTimestamp,l=ee()(a.timestamp).format("LLLL");return r.a.createElement("div",{className:["message","".concat(t?"mine":""),"".concat(n?"start":""),"".concat(c?"end":"")].join(" ")},o&&r.a.createElement("div",{className:"timestamp"},l),r.a.createElement("div",{className:"bubble-container"},r.a.createElement("div",{className:"bubble",title:l},a.message)))}var te;t(210);function ne(){var e=Object(n.useState)([]),a=Object(g.a)(e,2),t=a[0],c=a[1],o=Object(n.useState)(""),l=Object(g.a)(o,2),u=l[0],m=l[1],d=Object(i.f)(),f=Object(i.g)(),p=U.a.parse(f.search).room,v=Object(s.b)(p?"/message/all/".concat(p):null).data,b=Object(s.b)(p?"conversations/get/".concat(p):null).data,E=localStorage.getItem("userId"),j=Object(n.useRef)(null);Object(n.useEffect)((function(){c(v||[])}),[v]),Object(n.useEffect)((function(){j&&j.current.scrollIntoView({behavior:"smooth"})}),[t]),Object(n.useEffect)((function(){if(p)return(te=X()("http://localhost:8080")).on("connect",(function(){te.emit("JoinRoom",{room:p,id:E},(function(e){d.replace("/chat?room=".concat(e))}))})),function(){te.disconnect()}}),[p]),Object(n.useEffect)((function(){p&&te.on("Message",(function(e){console.log("Got msg",e),c((function(a){return[].concat(Object(L.a)(a),[e])}))}))}),[p]);return r.a.createElement("div",{className:"message-list"},r.a.createElement(P,{title:null===b||void 0===b?void 0:b.name,rightItems:[r.a.createElement(R,{key:"info",icon:"ion-ios-information-circle-outline"})]}),r.a.createElement("div",{className:"message-list-container"},p?function(){for(var e=0,a=(t||[]).length,n=[];e<a;){var c=t[e-1],o=t[e],l=t[e+1],i=o.sender===E,s=ee()(o.timestamp),u=!0,m=!0,d=!0;if(c){var f=ee()(c.timestamp),p=ee.a.duration(s.diff(f));c.sender===o.sender&&p.as("hours")<1&&(u=!1),p.as("hours")<1&&(d=!1)}if(l){var v=ee()(l.timestamp),g=ee.a.duration(v.diff(s));l.sender===o.sender&&g.as("hours")<1&&(m=!1)}n.push(r.a.createElement(ae,{key:e,isMine:i,startsSequence:u,endsSequence:m,showTimestamp:d,data:o})),e+=1}return n}():r.a.createElement("p",null,"Select a conversation from left side."),r.a.createElement("div",{style:{float:"left",clear:"both"},ref:j})),r.a.createElement("form",{className:"compose",onSubmit:function(e){e.preventDefault();var a={message:u,sender:E,roomId:p};console.log("sent msg payload",a),te.emit("Message",a),m(""),c((function(e){return[].concat(Object(L.a)(e),[a])}))}},r.a.createElement(h.a,{fullWidth:!0,placeholder:"Type your message....",className:"box-input",onChange:function(e){return m(e.target.value)},value:u})))}t(211);function re(){return r.a.createElement("div",{className:"messenger"},r.a.createElement("div",{className:"scrollable sidebar"},r.a.createElement(K,null)),r.a.createElement("div",{className:"scrollable content"},r.a.createElement(ne,null)))}var ce=function(e){return I.get(e).then((function(e){return e.data}))};var oe=function(){return r.a.createElement(s.a,{value:{fetcher:ce}},r.a.createElement(u.a,{maxSnack:4},r.a.createElement(m.a,null),r.a.createElement(l.a,{basename:"/"},r.a.createElement(i.c,null,r.a.createElement(i.a,{exact:!0,path:"/signup"},r.a.createElement(A,null)),r.a.createElement(i.a,{exact:!0,path:"/chat"},r.a.createElement(re,null)),r.a.createElement(i.a,{path:"/"},r.a.createElement(D,null))))))};Boolean("localhost"===window.location.hostname||"[::1]"===window.location.hostname||window.location.hostname.match(/^127(?:\.(?:25[0-5]|2[0-4][0-9]|[01]?[0-9][0-9]?)){3}$/));o.a.render(r.a.createElement(r.a.StrictMode,null,r.a.createElement(oe,null)),document.getElementById("root")),"serviceWorker"in navigator&&navigator.serviceWorker.ready.then((function(e){e.unregister()})).catch((function(e){console.error(e.message)}))}},[[135,1,2]]]);
//# sourceMappingURL=main.85dbb2d2.chunk.js.map